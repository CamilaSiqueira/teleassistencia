<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">
    <h:head>

    </h:head>

    <h:body>
        <p:breadCrumb>
            <p:menuitem value="Home" title="Página principal" url="/home.xhtml" />
            <p:menuitem value="Registros" url="/registro.xhtml" />
            <p:menuitem value="Clientes" url="/buscacliente.xhtml" />
            <p:menuitem value="Novo Cliente" url="/novocliente.xhtml" />
        </p:breadCrumb>
        <p:panel id="painelUsuario" header="Usuario"
                 style="margin-bottom:10px;">
            <h:form id="formUsuario">
                <p:growl id="growl" showDetail="true" sticky="true" />
                <h:panelGrid columns="2" cellpadding="10">

                    <h:outputLabel value="Nome:" style="font-weight:bold" />
                    <h:outputLabel value="#{clienteFinalMB.usuarioSelecionado.nome}" />

                    <h:outputLabel value="CPF:" style="font-weight:bold" />
                    <h:outputLabel value="#{clienteFinalMB.usuarioSelecionado.cpf}" />

                    <h:outputLabel value="RG:" style="font-weight:bold" />
                    <h:outputLabel value="#{clienteFinalMB.usuarioSelecionado.rg}" />

                </h:panelGrid>

                <p:commandButton title="Alterar dados do usuário"
                                 icon="ui-icon-pencil" onclick="alterarUsuario.show()" ajax="true" />
                <p:commandButton title="Excluir" icon="ui-icon-trash"
                                 onclick="confirmarExcluirUsuario.show()" ajax="true" />


                <p:dialog header="Alterar dados do Usuário"
                          widgetVar="alterarUsuario" modal="true" showEffect="fade"
                          hideEffect="fade" resizable="false">
                    <h:panelGrid columns="2" cellpadding="5">

                        <h:outputLabel for="nome" value="Nome:" />
                        <p:inputText id="nome"
                                     value="#{clienteFinalMB.usuarioSelecionado.nome}" required="true" />

                        <h:outputLabel for="cpf" value="CPF:" />
                        <p:inputText id="cpf"
                                     value="#{clienteFinalMB.usuarioSelecionado.cpf}" required="true" />

                        <h:outputLabel for="rg" value="RG" />
                        <p:inputText id="rg"
                                     value="#{clienteFinalMB.usuarioSelecionado.rg}" required="true" />


                    </h:panelGrid>

                    <p:commandButton title="Salvar" value="Salvar alterações"
                                     oncomplete="alterarUsuario.hide();"
                                     actionListener="#{clienteFinalMB.alterarUsuario}"
                                     update=":formUsuario" />

                </p:dialog>

            </h:form>

            <p:separator />

            <h:form id="formPrestador">
                <p:panel header="Prestadores de Socorro"
                         style="margin-bottom:5px;">


                    <p:outputPanel id="painelTabelaPrestadores">

                        <p:dataTable id="tabelaPrestadores"
                                     value="#{clienteFinalMB.listaPrestadores}" var="prestador">
                            <p:column headerText="Matrícula">
                                <h:outputText value="#{prestador.matriculaSocorro}" />
                            </p:column>
                            <p:column headerText="CNPJ">
                                <h:outputText value="#{prestador.inscricaoFederal}" />
                            </p:column>
                            <p:column headerText="Inc. Estadual">
                                <h:outputText value="#{prestador.inscricaoEstadual}" />
                            </p:column>
                            <p:column headerText="Telefone">
                                <h:outputText value="#{prestador.telefone}" />
                            </p:column>
                            <p:column style="width:32px;text-align: center">

                                <p:commandButton title="Alterar dados do prestador de socorros"
                                                 icon="ui-icon-pencil" onclick="alterarPrestador.show()"
                                                 ajax="false">
                                    <f:setPropertyActionListener value="#{prestador}"
                                                                 target="#{clienteFinalMB.prestadorSelecionado}" />
                                </p:commandButton>

                                <p:commandButton title="Excluir" icon="ui-icon-trash"
                                                 onclick="confirmarExcluirPrestador.show()" ajax="true"  >
                                    <f:setPropertyActionListener value="#{prestador}"
                                                                 target="#{clienteFinalMB.prestadorSelecionado}" />
                                </p:commandButton>

                            </p:column>
                        </p:dataTable>
                        <p:commandButton title="Adicionar novo Prestador"
                                         icon="ui-icon-plus" onclick="alterarPrestador.show()" ajax="true" />
                    </p:outputPanel>
                </p:panel>

                <p:dialog header="Dados do Prestador de Serviços"
                          widgetVar="alterarPrestador" modal="true" showEffect="fade"
                          hideEffect="fade" resizable="false">
                    <h:panelGrid columns="2" cellpadding="5">

                        <h:outputLabel for="matricula" value="Matricula:" />
                        <p:inputText id="matricula"
                                     value="#{clienteFinalMB.prestadorSelecionado.matriculaSocorro}"
                                     required="true" />

                        <h:outputLabel for="inscFederal" value="Inscrição Federal" />
                        <p:inputText id="inscFederal"
                                     value="#{clienteFinalMB.prestadorSelecionado.inscricaoFederal}"
                                     required="true" />

                        <h:outputLabel for="inscEstadual" value="Inscrição Estadual" />
                        <p:inputText id="inscEstadual"
                                     value="#{clienteFinalMB.prestadorSelecionado.inscricaoEstadual}"
                                     required="true" />

                        <h:outputLabel for="telefone" value="Telefone" />
                        <p:inputText id="telefone"
                                     value="#{clienteFinalMB.prestadorSelecionado.telefone}"
                                     required="true" />

                    </h:panelGrid>


                    <p:commandButton title="Salvar" value="Salvar alterações"
                                     oncomplete="alterarPrestador.hide();"
                                     actionListener="#{clienteFinalMB.manterPrestador}"
                                     update=":formUsuario:growl :formPrestador:tabelaPrestadores" ajax="true" />

                </p:dialog>

            </h:form> 





        </p:panel>











        <h:form id="excluirUsuario">
            <p:confirmDialog
                message="Deseja realmente excluir este Usuário? Esta ação não poderá ser desfeita."
                hideEffect="explode" header="Aviso" severity="alert"
                widgetVar="confirmarExcluirUsuario">
                <p:commandButton id="btnSim" value="Sim"
                                 actionListener="#{clienteFinalMB.excluirUsuario}"
                                 oncomplete="confirmarExcluirUsuario.hide();" />
                <p:commandButton id="btnNao" value="Não"
                                 onclick="confirmarExcluirUsuario.hide()" type="button" />
            </p:confirmDialog>
        </h:form>

        <h:form id="excluirPrestador">
            <p:confirmDialog
                message="Deseja realmente excluir este Prestador? Esta ação não poderá ser desfeita."
                hideEffect="explode" header="Aviso" severity="alert"
                widgetVar="confirmarExcluirPrestador">
                <p:commandButton id="btnSim" value="Sim"
                                 actionListener="#{clienteFinalMB.excluirPrestador}"
                                 oncomplete="confirmarExcluirPrestador.hide();" />
                <p:commandButton id="btnNao" value="Não"
                                 onclick="confirmarExcluirPrestador.hide()" type="button" />
            </p:confirmDialog>
        </h:form>
    </h:body>
</html>